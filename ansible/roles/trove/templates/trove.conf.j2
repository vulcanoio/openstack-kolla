[DEFAULT]
debug = {{ trove_logging_debug }}

log_dir = /var/log/kolla/trove
rpc_backend = rabbit
port = {{ trove_api_port }}
host = {{ hostvars[inventory_hostname]['ansible_' + api_interface]['ipv4']['address'] }}
trove_api_workers = {{ openstack_service_workers }}
auth_strategy = keystone

db_api_implementation = "trove.db.sqlalchemy.api"
trove_auth_url = {{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ trove_api_port }}/v3
{% if enable_nova | bool %}
nova_compute_url = {{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ nova_api_port }}/v2
{% endif %}
{% if enable_cinder | bool %}
cinder_url = {{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ cinder_api_port }}/v2
{% endif %}
{% if enable_swift | bool %}
swift_url = {{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ swift_api_port }}/v1
{% endif %}

network_label_regex = .*
trove_volume_support = True
block_device_mapping = vdb
device_path = /dev/vdb

trove_dns_support = False
nova_proxy_admin_pass = {{ trove_keystone_password }}
nova_proxy_admin_tenant_name = services
nova_proxy_admin_user = trove

{% if enable_neutron | bool %}
network_driver = trove.network.neutron.NeutronDriver
{% endif %}

taskmanager_queue = taskmanager
admin_roles = admin

[database]
connection = mysql+pymysql://{{ trove_database_user }}:{{ trove_database_password }}@{{ trove_database_address }}/{{ trove_database_name }}

[mysql]
root_on_create = False
tcp_ports = 3306
volume_support = True
device_path = /dev/vdb

ignore_users = os_admin, root
ignore_dbs = mysql, information_schema, performance_schema

[redis]
tcp_ports = 6379
volume_support = False

[cassandra]
tcp_ports = 7000, 7001, 9042, 9160
volume_support = True
device_path = /dev/vdb

[couchbase]
tcp_ports = 8091, 8092, 4369, 11209-11211, 21100-21199
volume_support = True
device_path = /dev/vdb

[mongodb]
tcp_ports = 2500, 27017
volume_support = True
device_path = /dev/vdb
num_config_servers_per_cluster = 1
num_query_routers_per_cluster = 1

[vertica]
tcp_ports = 5433, 5434, 22, 5444, 5450, 4803
udp_ports = 5433, 4803, 4804, 6453
volume_support = True
device_path = /dev/vdb
cluster_support = True
cluster_member_count = 3
api_strategy = trove.common.strategies.cluster.experimental.vertica.api.VerticaAPIStrategy


[keystone_authtoken]
memcache_security_strategy = ENCRYPT
memcache_secret_key = {{ memcache_secret_key }}
memcached_servers = {{ kolla_internal_fqdn }}:{{ memcached_port }}
auth_uri = {{ internal_protocol }}://{{ kolla_internal_fqdn }}:{{ keystone_public_port }}/v3
project_domain_name = Default
project_name = service
user_domain_name = Default
username = {{ trove_keystone_user }}
password = {{ trove_keystone_password }}
auth_url = {{ admin_protocol }}://{{ kolla_internal_fqdn }}:{{ keystone_admin_port }}/v3
auth_type = password

[oslo_messaging_rabbit]
rabbit_userid = {{ rabbitmq_user }}
rabbit_password = {{ rabbitmq_password }}
rabbit_ha_queues = true
rabbit_hosts = {% for host in groups['rabbitmq'] %}{{ hostvars[host]['ansible_' + hostvars[host]['api_interface']]['ipv4']['address'] }}:{{ rabbitmq_port }}{% if not loop.last %},{% endif %}{% endfor %}

[service_credentials]
auth_url = {{ internal_protocol  }}://{{ kolla_internal_fqdn }}:{{ keystone_public_port }}/v3
region_name = {{ openstack_region_name }}
password = {{ trove_keystone_password }}
username = {{ trove_keystone_user }}
project_name = service
project_domain_id = default
user_domain_id = default
auth_type = password
